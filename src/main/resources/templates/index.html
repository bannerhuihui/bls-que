<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>用户登录页面</title>
    <link rel="stylesheet" href="/css/layui.css">
    <style>
        .centered-form {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        .form-container {
            width: 100%;
            max-width: 500px; /* 你可以根据需要调整这个宽度 */
            padding: 20px;
        }
    </style>
</head>
<body>
<div class="centered-form">
    <div class="form-container">
        <form class="layui-form" action="">
            <div class="layui-form-item">
                <label class="layui-form-label">登录名</label>
                <div class="layui-input-block">
                    <input type="text" name="userName" required lay-verify="required" placeholder="请输入登录名" class="layui-input ">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">密码</label>
                <div class="layui-input-block">
                    <input type="password" name="passWord" required lay-verify="required|pass" placeholder="请输入密码" lay-affix="eye" class="layui-input">
                </div>
            </div>

            <div class="layui-form-item">
                <div class="layui-input-block">
                    <button class="layui-btn " style="width: 100%" type="submit" lay-submit lay-filter="demo1">登录</button>
                </div>
            </div>
        </form>
    </div>
</div>
<script src="/js/layui.js"></script>
<script src="/js/common.js"></script>
<script>
    layui.use(['form', 'laydate', 'util'], function(){
        var form = layui.form;
        var layer = layui.layer;
        var $ =layui.$;

        // 自定义验证规则
        form.verify({
            pass: function(value) {
                if (!/(.+){6,12}$/.test(value)) {
                    return '密码必须 6 到 12 位';
                }
            }
        });

        // 提交事件
        form.on('submit(demo1)', function(data){
            var field = data.field; // 获取表单字段值
            $.ajax({
                url:"/user/login",
                type:"POST",
                data:field,
                success:function (data) {

                    if(data.id !== null && data.id !== undefined){
                        //执行页面跳转
                        if(data.token !== null && data.token !== undefined && data.token !== ""){
                            //将token存储到LocalStorage
                            const token = data.token;
                            localStorage.setItem('token', token);
                        }
                        window.location.href = "/page/home?userId="+data.id+"&userName="+data.userName;
                    } else {
                        layer.msg('登录失败！', {icon: 2, time: 2000});
                    }
                }
            });
            return false; // 阻止默认 form 跳转
        });
    });
</script>
</body>
</html>