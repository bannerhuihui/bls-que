<!DOCTYPE html>
<html lang="zh-CN" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>首页</title>
    <link rel="stylesheet" href="/css/layui.css">
    <style>
        #center-iframe{
            width: 100%;
            height: 100%;
            border: none;
        }
    </style>
</head>
<body>
<div class="layui-layout layui-layout-admin">
    <div class="layui-header">
        <div class="layui-logo layui-hide-xs layui-bg-black">百乐思问卷管理</div>
        <!-- 头部区域（可配合layui 已有的水平导航） -->
        <ul class="layui-nav layui-layout-right">
            <li class="layui-nav-item layui-hide layui-show-sm-inline-block">
                <a href="javascript:;">
                    <img src="/images/user-phone.jpg" class="layui-nav-img">
                    <span th:text="${userName}"></span>
                    <input type="text" hidden th:value="${userId}" name="userId">
                </a>
                <dl class="layui-nav-child">
                    <dd><a href="javascript:;" >个人信息</a></dd>
                    <dd><a href="javascript:;" id="exit">退出</a></dd>
                </dl>
            </li>
        </ul>
    </div>
    <div class="layui-side layui-bg-black">
        <div class="layui-side-scroll">
            <!-- 左侧导航区域（可配合layui已有的垂直导航） -->
            <ul class="layui-nav layui-nav-tree" lay-filter="test">
                <li class="layui-nav-item layui-nav-itemed" >
                    <a href="javascript:;">问卷管理</a>
                    <dl class="layui-nav-child">
                        <dd class="layui-this" id="history_list"> <a href="javascript:;" onclick="changeIfram('history-list')">问卷列表</a></dd>
                        <dd><a href="javascript:;" onclick="changeIfram('create-history')">添加问卷</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item ">
                    <a class="" href="javascript:;">用户管理</a>
                    <dl class="layui-nav-child">
                        <dd><a onclick="changeIfram('user-list')">用户列表</a></dd>
                        <dd><a onclick="changeIfram('create-user')">添加用户</a></dd>
                    </dl>
                </li>

            </ul>
        </div>
    </div>
    <div class="layui-body">
        <iframe id="center-iframe" src="/page/history-list.html" frameborder="1" allowfullscreen></iframe>
    </div>
    <div class="layui-footer">
        <!-- 底部固定区域 -->
    </div>
</div>

<script src="/js/layui.js"></script>
<script type="text/javascript">
    var userId = "";
    //页面跳转方法
    function changeIfram(v){
        var iframe = document.getElementById('center-iframe');
        iframe.src = "/page/"+v + ".html";
    }
    //JS
    layui.use(['element', 'layer', 'util'], function(){
        var element = layui.element;
        var layer = layui.layer;
        var util = layui.util;
        var $ = layui.$;
        userId = $("input[name='userId']").val();
        //头部事件
        util.event('lay-header-event', {
            menuLeft: function(othis){ // 左侧菜单事件
                layer.msg('展开左侧菜单的操作', {icon: 0});
            },
            menuRight: function(){  // 右侧菜单事件
                layer.open({
                    type: 1,
                    title: '更多',
                    content: '<div style="padding: 15px;">处理右侧面板的操作</div>',
                    area: ['260px', '100%'],
                    offset: 'rt', // 右上角
                    anim: 'slideLeft', // 从右侧抽屉滑出
                    shadeClose: true,
                    scrollbar: false
                });
            }
        });
        $("#exit").click(function (){
            //执行登出操作
            $.ajax({
                url:"/user/logout",
                type:"GET",
                data:{"userId":parseInt($("[name = 'userId']").val())},
                success:function (data) {
                    if(data === "success"){
                        //执行页面跳转
                        window.location.href = "/page/goto/index";
                    } else {
                        layer.msg('网络异常，请稍后再试！', {icon: 2, time: 2000});
                    }
                }
            });
        });
    });
</script>
</body>
</html>